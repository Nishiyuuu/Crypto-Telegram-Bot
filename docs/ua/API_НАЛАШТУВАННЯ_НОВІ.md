# üîë API –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –¥–ª—è Crypto Telegram Bot

## üìã –û–≥–ª—è–¥ API

**–ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è (1.2.0)** –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –º—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π –Ω–∞–±—ñ—Ä API –¥–ª—è —Å—Ç–∞–±—ñ–ª—å–Ω–æ—ó —Ä–æ–±–æ—Ç–∏ –æ—Å–Ω–æ–≤–Ω–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π.

---

## ‚úÖ –ê–ö–¢–ò–í–ù–û –í–ò–ö–û–†–ò–°–¢–û–í–£–í–ê–ù–Ü API

### 1. ü§ñ Telegram Bot API

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –û–±–æ–≤'—è–∑–∫–æ–≤–æ  
**–í–∞—Ä—Ç—ñ—Å—Ç—å**: –ë–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ  
**–§—É–Ω–∫—Ü—ñ—è**: –û—Å–Ω–æ–≤–Ω–∏–π —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –±–æ—Ç–∞

#### –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è:
```env
# .env —Ñ–∞–π–ª
TELEGRAM_BOT_TOKEN=your_bot_token_here
```

#### –û—Ç—Ä–∏–º–∞–Ω–Ω—è —Ç–æ–∫–µ–Ω–∞:
1. –ù–∞–ø–∏—à—ñ—Ç—å [@BotFather](https://t.me/BotFather) –≤ Telegram
2. –°—Ç–≤–æ—Ä—ñ—Ç—å –Ω–æ–≤–æ–≥–æ –±–æ—Ç–∞ –∫–æ–º–∞–Ω–¥–æ—é `/newbot`
3. –°–∫–æ–ø—ñ—é–π—Ç–µ –æ—Ç—Ä–∏–º–∞–Ω–∏–π —Ç–æ–∫–µ–Ω
4. –î–æ–¥–∞–π—Ç–µ –¥–æ `.env` —Ñ–∞–π–ª—É

#### –î–µ—Ç–∞–ª—å–Ω–∏–π –≥–∞–π–¥:
- **[–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –±–æ—Ç–∞](../telegram-setup.md)** - –ø–æ–∫—Ä–æ–∫–æ–≤–∞ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è

### 2. üìà Binance API

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ê–∫—Ç–∏–≤–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è  
**–í–∞—Ä—Ç—ñ—Å—Ç—å**: –ë–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ  
**–§—É–Ω–∫—Ü—ñ—è**: –î–∂–µ—Ä–µ–ª–æ —Ü—ñ–Ω –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç

#### –û—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ:
- –ù–µ –ø–æ—Ç—Ä—ñ–±–µ–Ω API –∫–ª—é—á –¥–ª—è –ø—É–±–ª—ñ—á–Ω–∏—Ö –¥–∞–Ω–∏—Ö
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è —Ç—ñ–ª—å–∫–∏ –ø—É–±–ª—ñ—á–Ω—ñ endpoint'–∏
- –õ—ñ–º—ñ—Ç: 1200 –∑–∞–ø–∏—Ç—ñ–≤/—Ö–≤–∏–ª–∏–Ω—É

#### –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è:
```javascript
// src/handlers/price.js
const Binance = require('binance-api-node').default;
const client = Binance(); // –ë–µ–∑ –∫–ª—é—á—ñ–≤ –¥–ª—è –ø—É–±–ª—ñ—á–Ω–∏—Ö –¥–∞–Ω–∏—Ö
```

### 3. üóÑÔ∏è MongoDB Atlas

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –û–±–æ–≤'—è–∑–∫–æ–≤–æ  
**–í–∞—Ä—Ç—ñ—Å—Ç—å**: –ë–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ (M0 Sandbox)  
**–§—É–Ω–∫—Ü—ñ—è**: –ó–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤

#### –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è:
```env
# .env —Ñ–∞–π–ª
MONGO_URI=mongodb+srv://username:password@cluster.mongodb.net/crypto-bot
```

#### –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è:
1. –ó–∞—Ä–µ—î—Å—Ç—Ä—É–π—Ç–µ—Å—å –Ω–∞ [MongoDB Atlas](https://www.mongodb.com/cloud/atlas)
2. –°—Ç–≤–æ—Ä—ñ—Ç—å –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–∏–π cluster (M0)
3. –û—Ç—Ä–∏–º–∞–π—Ç–µ connection string
4. –î–æ–¥–∞–π—Ç–µ –¥–æ `.env` —Ñ–∞–π–ª—É

---

## üîÑ –ü–õ–ê–ù–£–Ñ–¢–¨–°–Ø –î–û–î–ê–¢–ò

### 4. ü¶é CoinGecko API (v1.3)

**–°—Ç–∞—Ç—É—Å**: üîÑ –ü–ª–∞–Ω—É—î—Ç—å—Å—è  
**–í–∞—Ä—Ç—ñ—Å—Ç—å**: –ë–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ / Pro ($129/–º—ñ—Å)  
**–§—É–Ω–∫—Ü—ñ—è**: –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–µ –¥–∂–µ—Ä–µ–ª–æ —Ü—ñ–Ω

#### –ü–µ—Ä–µ–≤–∞–≥–∏:
- –†–µ–∑–µ—Ä–≤–Ω–µ –¥–∂–µ—Ä–µ–ª–æ —Ü—ñ–Ω –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—ñ Binance
- –î–æ–¥–∞—Ç–∫–æ–≤–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –º–æ–Ω–µ—Ç–∏
- –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ –±—ñ–ª—å—à–æ—ó –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç

#### –ú–∞–π–±—É—Ç–Ω—î –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è:
```env
# –ë—É–¥–µ –¥–æ–¥–∞–Ω–æ –≤ v1.3
COINGECKO_API_KEY=your_api_key (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)
PRICE_API_PRIORITY=binance,coingecko
```

### 5. üí∞ CoinMarketCap API (v1.4)

**–°—Ç–∞—Ç—É—Å**: üîÑ –ü–ª–∞–Ω—É—î—Ç—å—Å—è  
**–í–∞—Ä—Ç—ñ—Å—Ç—å**: –ë–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ / Pro ($29/–º—ñ—Å)  
**–§—É–Ω–∫—Ü—ñ—è**: –î–æ–¥–∞—Ç–∫–æ–≤—ñ —Ä–∏–Ω–∫–æ–≤—ñ –¥–∞–Ω—ñ

#### –ü–µ—Ä–µ–≤–∞–≥–∏:
- –†–∏–Ω–∫–æ–≤–∞ –∫–∞–ø—ñ—Ç–∞–ª—ñ–∑–∞—Ü—ñ—è
- –û–±'—î–º–∏ —Ç–æ—Ä–≥—ñ–≤–ª—ñ
- –†–µ–π—Ç–∏–Ω–≥–∏ –º–æ–Ω–µ—Ç

---

## ‚öôÔ∏è –ö–û–ù–§–Ü–ì–£–†–ê–¶–Ü–Ø –ü–û–¢–û–ß–ù–û–á –í–ï–†–°–Ü–á

### –ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π .env —Ñ–∞–π–ª:
```env
# –û–±–æ–≤'—è–∑–∫–æ–≤—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
TELEGRAM_BOT_TOKEN=1234567890:ABCdefGHIjklMNOpqrsTUVwxyz
MONGO_URI=mongodb+srv://user:pass@cluster.mongodb.net/crypto-bot

# –û–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
NODE_ENV=production
PORT=3000
LOG_LEVEL=info
```

### –ü–æ–≤–Ω–∏–π .env —Ñ–∞–π–ª:
```env
# Telegram Bot
TELEGRAM_BOT_TOKEN=your_telegram_bot_token

# –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö
MONGO_URI=mongodb+srv://username:password@cluster.mongodb.net/crypto-bot

# –°–µ—Ä–µ–¥–æ–≤–∏—â–µ
NODE_ENV=production
PORT=3000

# –õ–æ–≥—É–≤–∞–Ω–Ω—è
LOG_LEVEL=info
LOG_FILE=./src/logs/combined.log

# –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥
MONITOR_INTERVAL=15000
MESSAGE_DELAY=100

# –û–±–º–µ–∂–µ–Ω–Ω—è
RATE_LIMIT=true
RATE_LIMIT_WINDOW=60000
RATE_LIMIT_MAX=30
```

---

## üîß –ù–ê–õ–ê–®–¢–£–í–ê–ù–ù–Ø –†–û–ó–†–û–ë–ö–ò

### –õ–æ–∫–∞–ª—å–Ω–∞ —Ä–æ–∑—Ä–æ–±–∫–∞:
```env
# .env.local
NODE_ENV=development
TELEGRAM_BOT_TOKEN=your_dev_bot_token
MONGO_URI=mongodb://localhost:27017/crypto-bot-dev
LOG_LEVEL=debug
```

### –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è:
```env
# .env.test
NODE_ENV=test
TELEGRAM_BOT_TOKEN=test_bot_token
MONGO_URI=mongodb://localhost:27017/crypto-bot-test
LOG_LEVEL=error
```

---

## üìä –õ–Ü–ú–Ü–¢–ò –¢–ê –û–ë–ú–ï–ñ–ï–ù–ù–Ø

### Binance API:
- **–ü—É–±–ª—ñ—á–Ω—ñ endpoint'–∏**: 1200 –∑–∞–ø–∏—Ç—ñ–≤/—Ö–≤–∏–ª–∏–Ω—É
- **–ë–µ–∑ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó**: –¢—ñ–ª—å–∫–∏ –ø—É–±–ª—ñ—á–Ω—ñ –¥–∞–Ω—ñ
- **Rate limiting**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ–±–º–µ–∂–µ–Ω–Ω—è –∑–∞–ø–∏—Ç—ñ–≤

### MongoDB Atlas (M0):
- **–ó–±–µ—Ä—ñ–≥–∞–Ω–Ω—è**: 512 MB
- **–ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è**: 100 –æ–¥–Ω–æ—á–∞—Å–Ω–∏—Ö
- **–¢—Ä–∞—Ñ—ñ–∫**: –ù–µ–æ–±–º–µ–∂–µ–Ω–∏–π

### Telegram Bot API:
- **–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è**: 30 –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å/—Å–µ–∫—É–Ω–¥—É
- **–ì—Ä—É–ø–æ–≤–∏–π —á–∞—Ç**: 20 –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å/—Ö–≤–∏–ª–∏–Ω—É
- **–§–∞–π–ª–∏**: –î–æ 50 MB

---

## üö® –í–ê–ñ–õ–ò–í–Ü –ü–†–ò–ú–Ü–¢–ö–ò

### –ë–µ–∑–ø–µ–∫–∞:
- ‚ùå **–ù–Ü–ö–û–õ–ò** –Ω–µ –∫–æ–º–º—ñ—Ç—å—Ç–µ `.env` —Ñ–∞–π–ª–∏ –≤ Git
- ‚úÖ –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ `.env.example` —è–∫ —à–∞–±–ª–æ–Ω
- ‚úÖ –†–µ–≥—É–ª—è—Ä–Ω–æ –∑–º—ñ–Ω—é–π—Ç–µ API –∫–ª—é—á—ñ
- ‚úÖ –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —Ä—ñ–∑–Ω—ñ –∫–ª—é—á—ñ –¥–ª—è dev/prod

### –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥:
- üìä –í—ñ–¥—Å—Ç–µ–∂—É–π—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è API –ª—ñ–º—ñ—Ç—ñ–≤
- üìä –ú–æ–Ω—ñ—Ç–æ—Ä—å—Ç–µ –ø–æ–º–∏–ª–∫–∏ API –≤ –ª–æ–≥–∞—Ö
- üìä –ù–∞–ª–∞—à—Ç—É–π—Ç–µ –∞–ª–µ—Ä—Ç–∏ –Ω–∞ –∫—Ä–∏—Ç–∏—á–Ω—ñ –ø–æ–º–∏–ª–∫–∏

### Backup:
- üíæ –†–µ–≥—É–ª—è—Ä–Ω–æ —Ä–æ–±—ñ—Ç—å backup MongoDB
- üíæ –ó–±–µ—Ä—ñ–≥–∞–π—Ç–µ –∫–æ–ø—ñ—ó `.env` —Ñ–∞–π–ª—ñ–≤ –≤ –±–µ–∑–ø–µ—á–Ω–æ–º—É –º—ñ—Å—Ü—ñ
- üíæ –î–æ–∫—É–º–µ–Ω—Ç—É–π—Ç–µ –≤—Å—ñ –∑–º—ñ–Ω–∏ –≤ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó

---

## üÜò –£–°–£–ù–ï–ù–ù–Ø –ü–†–û–ë–õ–ï–ú

### –ü–æ–º–∏–ª–∫–∏ Telegram Bot API:
```bash
# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞
curl https://api.telegram.org/bot<YOUR_TOKEN>/getMe

# –ü–æ–º–∏–ª–∫–∞ 409 - –∫–æ–Ω—Ñ–ª—ñ–∫—Ç webhook'—ñ–≤
npm run reset-telegram
```

### –ü–æ–º–∏–ª–∫–∏ Binance API:
```bash
# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—ñ
curl https://api.binance.com/api/v3/ping

# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ª—ñ–º—ñ—Ç—ñ–≤
curl https://api.binance.com/api/v3/exchangeInfo
```

### –ü–æ–º–∏–ª–∫–∏ MongoDB:
```bash
# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è
mongosh "mongodb+srv://cluster.mongodb.net/" --username username

# –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –≤ –∫–æ–¥—ñ
npm run test:db
```

---

*–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è –æ–Ω–æ–≤–ª–µ–Ω–∞: 17.01.2025*  
*–í–µ—Ä—Å—ñ—è API –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó: 1.2.0*  
*–°—Ç–∞—Ç—É—Å: –°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–æ–≤–∞–Ω–æ –∑ –∫–æ–¥–æ–º ‚úÖ*
